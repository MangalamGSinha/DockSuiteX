{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"DockSuiteX","text":"<p>All-in-one Protein-Ligand Docking Package</p> <p>DockSuiteX is a comprehensive Python package for molecular docking that integrates multiple tools including MGLTools, P2Rank, AutoDock Vina, and AutoDock4. It provides a unified, user-friendly interface for protein and ligand preparation, binding pocket prediction, and molecular docking simulations.</p>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>Automated Preparation: Streamlined protein and ligand preparation using PDBFixer and Open Babel</li> <li>Pocket Prediction: Binding pocket prediction with P2Rank machine learning</li> <li>Multiple Docking Engines: Support for both AutoDock Vina and AutoDock4</li> <li>Batch Processing: High-throughput screening with parallel execution</li> <li>Interactive Visualization: 3D molecular visualization with NGLView</li> <li>Utility Functions: Built-in tools for fetching structures and parsing results</li> </ul>"},{"location":"#platform-support","title":"Platform Support","text":"<p>Windows Only</p> <p>DockSuiteX currently supports Windows platforms only. The package includes pre-compiled binaries for Windows.</p>"},{"location":"#quick-example","title":"Quick Example","text":"<pre><code>from docksuitex import Protein, Ligand, VinaDocking\n\n# Prepare protein\nprotein = Protein(\"protein.pdb\")\nprotein.prepare(save_to=\"prepared_protein.pdbqt\")\n\n# Prepare ligand\nligand = Ligand(\"ligand.sdf\")\nligand.prepare(save_to=\"prepared_ligand.pdbqt\")\n\n# Run docking\ndocking = VinaDocking(\n    receptor=\"prepared_protein.pdbqt\",\n    ligand=\"prepared_ligand.pdbqt\",\n    grid_center=(10.0, 15.0, 20.0)\n)\nresults = docking.run()\n</code></pre>"},{"location":"#integrated-tools","title":"Integrated Tools","text":"<p>DockSuiteX bundles and integrates the following tools:</p> <ul> <li>MGLTools: Protein and ligand preparation (prepare_receptor4.py, prepare_ligand4.py)</li> <li>AutoDock Vina: Fast gradient-based docking</li> <li>AutoDock4: Classic genetic algorithm-based docking</li> <li>P2Rank: Machine learning pocket prediction</li> <li>Open Babel: Format conversion and energy minimization</li> <li>PDBFixer: Protein structure repair</li> </ul>"},{"location":"#getting-started","title":"Getting Started","text":"<p>Check out the Installation Guide to get started, or jump straight to the Quick Start Tutorial to see DockSuiteX in action!</p>"},{"location":"#acknowledgments","title":"Acknowledgments","text":"<p>This package builds upon and automates workflows using:</p> <ul> <li>AutoDock4 &amp; AutoDock Vina</li> <li>MGLTools</li> <li>Open Babel</li> <li>PDBFixer</li> <li>P2Rank</li> <li>RCSB PDB &amp; PubChem</li> <li>NGLView</li> </ul> <p>For detailed citations, see the Citations page.</p>"},{"location":"about/changelog/","title":"Changelog","text":""},{"location":"about/changelog/#v010","title":"v0.1.0","text":"<ul> <li>Initial release</li> </ul>"},{"location":"about/cite/","title":"Citations","text":"<p>If you use DockSuiteX in your research, please cite the following papers:</p>"},{"location":"about/cite/#docksuitex","title":"DockSuiteX","text":"<pre><code>@article{docksuitex2024,\n  title={DockSuiteX: An All-in-One Protein-Ligand Docking Package},\n  author={Your Name},\n  journal={Journal Name},\n  year={2024},\n  volume={XX},\n  pages={XXX-XXX},\n  doi={10.XXXX/XXXXX}\n}\n</code></pre>"},{"location":"about/cite/#integrated-tools","title":"Integrated Tools","text":"<p>DockSuiteX builds upon the following excellent tools. Please cite them as appropriate:</p>"},{"location":"about/cite/#autodock-vina","title":"AutoDock Vina","text":"<pre><code>@article{trott2010autodock,\n  title={AutoDock Vina: improving the speed and accuracy of docking with a new scoring function, efficient optimization, and multithreading},\n  author={Trott, Oleg and Olson, Arthur J},\n  journal={Journal of computational chemistry},\n  volume={31},\n  number={2},\n  pages={455--461},\n  year={2010},\n  publisher={Wiley Online Library},\n  doi={10.1002/jcc.21334}\n}\n</code></pre> <p>Reference: Trott, O., &amp; Olson, A. J. (2010). AutoDock Vina: improving the speed and accuracy of docking with a new scoring function, efficient optimization, and multithreading. Journal of computational chemistry, 31(2), 455-461.</p>"},{"location":"about/cite/#autodock4","title":"AutoDock4","text":"<pre><code>@article{morris2009autodock4,\n  title={AutoDock4 and AutoDockTools4: Automated docking with selective receptor flexibility},\n  author={Morris, Garrett M and Huey, Ruth and Lindstrom, William and Sanner, Michel F and Belew, Richard K and Goodsell, David S and Olson, Arthur J},\n  journal={Journal of computational chemistry},\n  volume={30},\n  number={16},\n  pages={2785--2791},\n  year={2009},\n  publisher={Wiley Online Library},\n  doi={10.1002/jcc.21256}\n}\n</code></pre> <p>Reference: Morris, G. M., Huey, R., Lindstrom, W., Sanner, M. F., Belew, R. K., Goodsell, D. S., &amp; Olson, A. J. (2009). AutoDock4 and AutoDockTools4: Automated docking with selective receptor flexibility. Journal of computational chemistry, 30(16), 2785-2791.</p>"},{"location":"about/cite/#p2rank","title":"P2Rank","text":"<pre><code>@article{krivak2018p2rank,\n  title={P2Rank: machine learning based tool for rapid and accurate prediction of ligand binding sites from protein structure},\n  author={Kriv\u00e1k, Radoslav and Hoksza, David},\n  journal={Journal of cheminformatics},\n  volume={10},\n  number={1},\n  pages={1--12},\n  year={2018},\n  publisher={BioMed Central},\n  doi={10.1186/s13321-018-0285-8}\n}\n</code></pre> <p>Reference: Kriv\u00e1k, R., &amp; Hoksza, D. (2018). P2Rank: machine learning based tool for rapid and accurate prediction of ligand binding sites from protein structure. Journal of cheminformatics, 10(1), 1-12.</p>"},{"location":"about/cite/#open-babel","title":"Open Babel","text":"<pre><code>@article{oboyle2011open,\n  title={Open Babel: An open chemical toolbox},\n  author={O'Boyle, Noel M and Banck, Michael and James, Craig A and Morley, Chris and Vandermeersch, Tim and Hutchison, Geoffrey R},\n  journal={Journal of cheminformatics},\n  volume={3},\n  number={1},\n  pages={1--14},\n  year={2011},\n  publisher={BioMed Central},\n  doi={10.1186/1758-2946-3-33}\n}\n</code></pre> <p>Reference: O'Boyle, N. M., Banck, M., James, C. A., Morley, C., Vandermeersch, T., &amp; Hutchison, G. R. (2011). Open Babel: An open chemical toolbox. Journal of cheminformatics, 3(1), 1-14.</p>"},{"location":"about/cite/#mgltools","title":"MGLTools","text":"<pre><code>@article{sanner1999python,\n  title={Python: a programming language for software integration and development},\n  author={Sanner, Michel F},\n  journal={J Mol Graph Model},\n  volume={17},\n  number={1},\n  pages={57--61},\n  year={1999}\n}\n</code></pre> <p>Reference: Sanner, M. F. (1999). Python: a programming language for software integration and development. J Mol Graph Model, 17(1), 57-61.</p>"},{"location":"about/cite/#pdbfixer","title":"PDBFixer","text":"<pre><code>@misc{pdbfixer,\n  author = {Eastman, Peter and Swails, Jason and Chodera, John D. and McGibbon, Robert T. and Zhao, Yutong and Beauchamp, Kyle A. and Wang, Lee-Ping and Simmonett, Andrew C. and Harrigan, Matthew P. and Stern, Chaya D. and Wiewiora, Rafal P. and Brooks, Bernard R. and Pande, Vijay S.},\n  title = {PDBFixer},\n  year = {2017},\n  publisher = {GitHub},\n  journal = {GitHub repository},\n  howpublished = {\\url{https://github.com/openmm/pdbfixer}}\n}\n</code></pre> <p>Reference: PDBFixer is part of the OpenMM toolkit. Available at: https://github.com/openmm/pdbfixer</p>"},{"location":"about/cite/#nglview","title":"NGLView","text":"<pre><code>@article{nguyen2018nglview,\n  title={NGLview--interactive molecular graphics for Jupyter notebooks},\n  author={Nguyen, Hai and Case, David A and Rose, Alexander S},\n  journal={Bioinformatics},\n  volume={34},\n  number={7},\n  pages={1241--1242},\n  year={2018},\n  publisher={Oxford University Press},\n  doi={10.1093/bioinformatics/btx789}\n}\n</code></pre> <p>Reference: Nguyen, H., Case, D. A., &amp; Rose, A. S. (2018). NGLview\u2013interactive molecular graphics for Jupyter notebooks. Bioinformatics, 34(7), 1241-1242.</p>"},{"location":"about/cite/#data-sources","title":"Data Sources","text":""},{"location":"about/cite/#rcsb-protein-data-bank","title":"RCSB Protein Data Bank","text":"<pre><code>@article{berman2000protein,\n  title={The protein data bank},\n  author={Berman, Helen M and Westbrook, John and Feng, Zukang and Gilliland, Gary and Bhat, TN and Weissig, Helge and Shindyalov, Ilya N and Bourne, Philip E},\n  journal={Nucleic acids research},\n  volume={28},\n  number={1},\n  pages={235--242},\n  year={2000},\n  publisher={Oxford University Press},\n  doi={10.1093/nar/28.1.235}\n}\n</code></pre> <p>Reference: Berman, H. M., Westbrook, J., Feng, Z., Gilliland, G., Bhat, T. N., Weissig, H., ... &amp; Bourne, P. E. (2000). The protein data bank. Nucleic acids research, 28(1), 235-242.</p>"},{"location":"about/cite/#pubchem","title":"PubChem","text":"<pre><code>@article{kim2021pubchem,\n  title={PubChem in 2021: new data content and improved web interfaces},\n  author={Kim, Sunghwan and Chen, Jie and Cheng, Tiejun and Gindulyte, Asta and He, Jia and He, Siqian and Li, Qingliang and Shoemaker, Benjamin A and Thiessen, Paul A and Yu, Bo and others},\n  journal={Nucleic acids research},\n  volume={49},\n  number={D1},\n  pages={D1388--D1395},\n  year={2021},\n  publisher={Oxford University Press},\n  doi={10.1093/nar/gkaa971}\n}\n</code></pre> <p>Reference: Kim, S., Chen, J., Cheng, T., Gindulyte, A., He, J., He, S., ... &amp; Bolton, E. E. (2021). PubChem in 2021: new data content and improved web interfaces. Nucleic acids research, 49(D1), D1388-D1395.</p>"},{"location":"about/cite/#how-to-cite","title":"How to Cite","text":"<p>When using DockSuiteX in your research, we recommend citing:</p> <ol> <li>DockSuiteX (main package)</li> <li>The specific docking engine(s) you used (AutoDock Vina and/or AutoDock4)</li> <li>P2Rank if you used pocket prediction</li> <li>Other tools as appropriate for your workflow</li> </ol>"},{"location":"about/cite/#example-citation-in-methods-section","title":"Example Citation in Methods Section","text":"<p>\"Molecular docking was performed using DockSuiteX (Your citation), which integrates AutoDock Vina (Trott &amp; Olson, 2010) for docking simulations and P2Rank (Kriv\u00e1k &amp; Hoksza, 2018) for binding pocket prediction. Protein and ligand structures were prepared using PDBFixer and Open Babel (O'Boyle et al., 2011).\"</p>"},{"location":"about/contributing/","title":"Contributing","text":"<p>We welcome contributions! Please see our GitHub repository for more details.</p>"},{"location":"about/license/","title":"License","text":"<p>DockSuiteX is released under the MIT License.</p>"},{"location":"api/autodock4/","title":"AD4Docking","text":""},{"location":"api/autodock4/#docksuitex.autodock4.AD4Docking","title":"docksuitex.autodock4.AD4Docking","text":"<pre><code>AD4Docking(\n    receptor: Union[str, Path, Protein],\n    ligand: Union[str, Path, Ligand],\n    grid_center: tuple[float, float, float],\n    grid_size: tuple[int, int, int] = (60, 60, 60),\n    spacing: float = 0.375,\n    dielectric: float = -0.1465,\n    smooth: float = 0.5,\n    ga_pop_size: int = 150,\n    ga_num_evals: int = 2500000,\n    ga_num_generations: int = 27000,\n    ga_elitism: int = 1,\n    ga_mutation_rate: float = 0.02,\n    ga_crossover_rate: float = 0.8,\n    ga_run: int = 10,\n    rmstol: float = 2.0,\n    seed: tuple[Union[int, str], Union[int, str]] = (\n        \"pid\",\n        \"time\",\n    ),\n)\n</code></pre> <p>A Python wrapper for AutoDock4 and AutoGrid to automate receptor\u2013ligand docking.</p> <p>This class automates receptor\u2013ligand docking using AutoDock4. It prepares grid parameter (GPF) and docking parameter (DPF) files, runs AutoGrid and AutoDock, and saves docking results.</p> <p>Initialize an AutoDock4 docking run.</p>"},{"location":"api/autodock4/#docksuitex.autodock4.AD4Docking--parameters","title":"Parameters","text":"<p>receptor : str | Path     Path to the receptor PDBQT file. ligand : str | Path     Path to the ligand PDBQT file. grid_center : tuple[float, float, float], default=(0,0,0)     Grid box center coordinates. grid_size : tuple[int, int, int], default=(60,60,60)     Number of points in the grid box. spacing : float, default=0.375     Grid spacing in \u00c5. dielectric : float, default=-0.1465     Dielectric constant for electrostatics. smooth : float, default=0.5     Smoothing factor for potential maps. ga_pop_size : int, default=150     Genetic algorithm population size. ga_num_evals : int, default=2_500_000     Maximum number of energy evaluations in GA. ga_num_generations : int, default=27_000     Maximum number of generations in GA. ga_elitism : int, default=1     Number of top individuals preserved during GA. ga_mutation_rate : float, default=0.02     Probability of mutation in GA. ga_crossover_rate : float, default=0.8     Probability of crossover in GA. ga_run : int, default=10     Number of independent GA runs. rmstol : float, default=2.0     RMSD tolerance for clustering docking results. seed : tuple[int | str, int | str], default=(\"pid\", \"time\")     Each element can be an integer or the keywords \"pid\" or \"time\".</p>"},{"location":"api/autodock4/#docksuitex.autodock4.AD4Docking.run","title":"run","text":"<pre><code>run(save_to: Union[str, Path] = None) -&gt; Path\n</code></pre> <p>Runs AutoGrid and AutoDock for molecular docking.</p> <p>RuntimeError: If AutoGrid or AutoDock fails, or expected output     files (.fld or .dlg) are missing.</p>"},{"location":"api/autodock4/#docksuitex.autodock4.AD4Docking.view_results","title":"view_results","text":"<pre><code>view_results()\n</code></pre> <p>Visualize docking results using NGLView.</p> <p>Opens the receptor and docked ligand in an interactive 3D widget inside a Jupyter notebook.</p> <p>Returns:</p> Type Description <p>nglview.NGLWidget: Interactive visualization of receptor\u2013ligand complex.</p>"},{"location":"api/batch-autodock4/","title":"BatchAD4Docking","text":""},{"location":"api/batch-autodock4/#docksuitex.batch_docking.batch_autodock4.BatchAD4Docking","title":"docksuitex.batch_docking.batch_autodock4.BatchAD4Docking","text":"<pre><code>BatchAD4Docking(\n    receptors_with_centers: Dict[\n        Union[str, Path],\n        Sequence[tuple[float, float, float]],\n    ],\n    ligands: Union[Sequence[Union[str, Path]], str, Path],\n    grid_size: tuple[int, int, int] = (60, 60, 60),\n    spacing: float = 0.375,\n    dielectric: float = -0.1465,\n    smooth: float = 0.5,\n    ga_pop_size: int = 150,\n    ga_num_evals: int = 2500000,\n    ga_num_generations: int = 27000,\n    ga_elitism: int = 1,\n    ga_mutation_rate: float = 0.02,\n    ga_crossover_rate: float = 0.8,\n    ga_run: int = 10,\n    rmstol: float = 2.0,\n    seed: tuple[Union[int, str], Union[int, str]] = (\n        \"pid\",\n        \"time\",\n    ),\n)\n</code></pre> <p>Batch docking manager for AutoDock4.</p> <p>Runs AutoDock4 docking for multiple ligands against multiple proteins, each with its own set of binding pocket centers, in parallel using a process pool.</p> <p>Initialize a batch docking job.</p> <p>Parameters:</p> Name Type Description Default <code>receptors_with_centers</code> <code>Dict[str | Path, Sequence[tuple[float, float, float]]]</code> <p>Dictionary mapping receptor PDBQT files to their list of binding pocket centers.</p> required <code>ligands</code> <code>Sequence[str | Path]</code> <p>List of ligand PDBQT files.</p> required <code>grid_size</code> <code>tuple[int, int, int]</code> <p>Number of grid points per axis. Defaults to (60, 60, 60).</p> <code>(60, 60, 60)</code> <code>spacing</code> <code>float</code> <p>Grid spacing in \u00c5. Defaults to 0.375.</p> <code>0.375</code> <code>dielectric</code> <code>float</code> <p>Dielectric constant. Defaults to -0.1465.</p> <code>-0.1465</code> <code>smooth</code> <code>float</code> <p>Smoothing factor for potential maps. Defaults to 0.5.</p> <code>0.5</code> <code>ga_pop_size</code> <code>int</code> <p>Genetic algorithm population size. Defaults to 150.</p> <code>150</code> <code>ga_num_evals</code> <code>int</code> <p>Max energy evaluations. Defaults to 2,500,000.</p> <code>2500000</code> <code>ga_num_generations</code> <code>int</code> <p>Max generations. Defaults to 27,000.</p> <code>27000</code> <code>ga_elitism</code> <code>int</code> <p>Elite individuals preserved. Defaults to 1.</p> <code>1</code> <code>ga_mutation_rate</code> <code>float</code> <p>GA mutation rate. Defaults to 0.02.</p> <code>0.02</code> <code>ga_crossover_rate</code> <code>float</code> <p>GA crossover rate. Defaults to 0.8.</p> <code>0.8</code> <code>ga_run</code> <code>int</code> <p>Independent GA runs. Defaults to 10.</p> <code>10</code> <code>rmstol</code> <code>float</code> <p>RMSD tolerance for clustering. Defaults to 2.0.</p> <code>2.0</code> <code>seed</code> <code>tuple[int | str, int | str]</code> <p>Random seed for docking.  Each element can be an integer or the keywords \"pid\" or \"time\".</p> <code>('pid', 'time')</code>"},{"location":"api/batch-autodock4/#docksuitex.batch_docking.batch_autodock4.BatchAD4Docking.run_all","title":"run_all","text":"<pre><code>run_all(\n    cpu: int = os.cpu_count() or 1,\n    save_to: Union[str, Path] = \"./batch_ad4_results\",\n) -&gt; dict[\n    tuple[str, str, tuple[float, float, float]],\n    Union[Path, str],\n]\n</code></pre> <p>Run AutoDock4 docking for all ligands \u00d7 all centers \u00d7 all receptors in parallel.</p> <p>Parameters:</p> Name Type Description Default <code>cpu</code> <code>int</code> <p>Total number of CPU cores to use. Defaults to all available cores. Each worker uses 1 CPU (AutoDock4 is single-threaded).</p> <code>cpu_count() or 1</code> <code>save_to</code> <code>str | Path</code> <p>Directory where results are stored.  Defaults to \"./batch_ad4_results\".</p> <code>'./batch_ad4_results'</code> <p>Returns:</p> Type Description <code>dict[tuple[str, str, tuple[float, float, float]], Union[Path, str]]</code> <p>dict[tuple[str, str, tuple[float, float, float]], Path | str]: Mapping from (receptor_name, ligand_name, center) to: - Path: Path to the docking result directory, if successful. - str: Error message if the docking failed.</p>"},{"location":"api/batch-ligand/","title":"BatchLigand","text":""},{"location":"api/batch-ligand/#docksuitex.batch_docking.batch_ligand.BatchLigand","title":"docksuitex.batch_docking.batch_ligand.BatchLigand","text":"<pre><code>BatchLigand(\n    inputs: Union[List[Union[str, Path]], str, Path],\n    minimize: Optional[str] = None,\n    remove_water: bool = True,\n    add_hydrogens: bool = True,\n    add_charges: bool = True,\n    preserve_charge_types: Optional[list[str]] = None,\n)\n</code></pre> <p>Handles batch ligand preparation in parallel.</p> Example <p>batch = BatchLigand(     inputs=\"ligands_folder\",     minimize=\"mmff94\",     remove_water=True,     add_hydrogens=True,     add_charges=True, ) batch.prepare_all(save_to=\"prepared_ligands\")</p> <p>Initialize the batch processor and preparation parameters.</p> <p>Parameters:</p> Name Type Description Default <code>inputs</code> <code>list[str | Path] | str | Path</code> <p>List of ligand files or directory containing ligand files.</p> required <code>minimize, remove_water, add_hydrogens, add_charges</code> <p>Preparation parameters (same as Ligand.prepare()).</p> required <code>preserve_charge_types</code> <code>list[str]</code> <p>Atom types to preserve charges for.</p> <code>None</code>"},{"location":"api/batch-ligand/#docksuitex.batch_docking.batch_ligand.BatchLigand.prepare_all","title":"prepare_all","text":"<pre><code>prepare_all(\n    save_to: Union[str, Path],\n    cpu: int = os.cpu_count() or 1,\n) -&gt; List[Dict[str, Union[str, Path, bool]]]\n</code></pre> <p>Prepare all ligands in batch and save PDBQT files to the specified folder.</p> <p>Parameters:</p> Name Type Description Default <code>save_to</code> <code>str | Path</code> <p>Directory to save all prepared PDBQT files.</p> required <code>cpu</code> <code>int</code> <p>Total number of CPU cores to use. Defaults to all available cores. Each worker uses 1 CPU.</p> <code>cpu_count() or 1</code> <p>Returns:</p> Type Description <code>List[Dict[str, Union[str, Path, bool]]]</code> <p>list[dict]: Result dictionary for each ligand file.</p>"},{"location":"api/batch-pocket-finder/","title":"BatchPocketFinder","text":""},{"location":"api/batch-pocket-finder/#docksuitex.batch_docking.batch_pocket_finder.BatchPocketFinder","title":"docksuitex.batch_docking.batch_pocket_finder.BatchPocketFinder","text":"<pre><code>BatchPocketFinder(\n    inputs: Union[List[Union[str, Path]], str, Path],\n)\n</code></pre> <p>Initialize the batch pocket finder.</p> <p>Parameters:</p> Name Type Description Default <code>inputs</code> <code>list[str | Path] | str | Path</code> <p>List of protein files (pdb/pdbqt) or directory containing them.</p> required"},{"location":"api/batch-pocket-finder/#docksuitex.batch_docking.batch_pocket_finder.BatchPocketFinder.run_all","title":"run_all","text":"<pre><code>run_all(\n    save_to: Union[str, Path],\n    cpu: int = os.cpu_count() or 1,\n) -&gt; Dict[str, List[Tuple[float, float, float]]]\n</code></pre> <p>Run pocket finding for all proteins in batch.</p> <p>Parameters:</p> Name Type Description Default <code>save_to</code> <code>str | Path</code> <p>Directory to save all results.</p> required <code>cpu</code> <code>int</code> <p>Total number of CPU cores to use. Defaults to all available cores. CPUs are divided among workers, with each worker receiving multiple CPUs for P2Rank.</p> <code>cpu_count() or 1</code> <p>Returns:</p> Type Description <code>Dict[str, List[Tuple[float, float, float]]]</code> <p>Dict[str, List[Tuple[float, float, float]]]:  Dictionary mapping absolute protein file path (str) to a list of center coordinates. Example: {\"/path/to/prot1.pdbqt\": [(1.0, 2.0, 3.0), ...]}</p>"},{"location":"api/batch-protein/","title":"BatchProtein","text":""},{"location":"api/batch-protein/#docksuitex.batch_docking.batch_protein.BatchProtein","title":"docksuitex.batch_docking.batch_protein.BatchProtein","text":"<pre><code>BatchProtein(\n    inputs: Union[List[Union[str, Path]], str, Path],\n    fix_pdb: bool = True,\n    remove_heterogens: bool = True,\n    add_hydrogens: bool = True,\n    remove_water: bool = True,\n    add_charges: bool = True,\n    preserve_charge_types: Optional[list[str]] = None,\n)\n</code></pre> <p>Initialize the batch processor and preparation parameters.</p> <p>Parameters:</p> Name Type Description Default <code>inputs</code> <code>list[str | Path] | str | Path</code> <p>List of protein files or directory containing protein files.</p> required <code>fix_pdb, remove_heterogens, add_hydrogens, remove_water, add_charges</code> <p>Preparation parameters (same as Protein.prepare()).</p> required <code>preserve_charge_types</code> <code>list[str]</code> <p>Atom types to preserve charges for.</p> <code>None</code>"},{"location":"api/batch-protein/#docksuitex.batch_docking.batch_protein.BatchProtein.prepare_all","title":"prepare_all","text":"<pre><code>prepare_all(\n    save_to: Union[str, Path],\n    cpu: int = os.cpu_count() or 1,\n) -&gt; List[Dict[str, Union[str, Path, bool]]]\n</code></pre> <p>Prepare all proteins in batch and save PDBQT files to the specified folder.</p> <p>Parameters:</p> Name Type Description Default <code>save_to</code> <code>str | Path</code> <p>Directory to save all prepared PDBQT files.</p> required <code>cpu</code> <code>int</code> <p>Total number of CPU cores to use. Defaults to all available cores. Each worker uses 1 CPU.</p> <code>cpu_count() or 1</code> <p>Returns:</p> Type Description <code>List[Dict[str, Union[str, Path, bool]]]</code> <p>list[dict]: Result dictionary for each protein file.</p>"},{"location":"api/batch-vina/","title":"BatchVinaDocking","text":""},{"location":"api/batch-vina/#docksuitex.batch_docking.batch_vina.BatchVinaDocking","title":"docksuitex.batch_docking.batch_vina.BatchVinaDocking","text":"<pre><code>BatchVinaDocking(\n    receptors_with_centers: Dict[\n        Union[str, Path],\n        Sequence[tuple[float, float, float]],\n    ],\n    ligands: Union[Sequence[Union[str, Path]], str, Path],\n    grid_size: tuple[int, int, int] = (20, 20, 20),\n    exhaustiveness: int = 8,\n    num_modes: int = 9,\n    verbosity: int = 1,\n    seed: int | None = None,\n)\n</code></pre> <p>Batch docking manager for AutoDock Vina.</p> <p>Runs AutoDock Vina docking for multiple ligands against multiple proteins, each with its own set of binding pocket centers, in parallel using a process pool.</p> <p>Initialize a batch Vina docking job.</p> <p>Parameters:</p> Name Type Description Default <code>receptors_with_centers</code> <code>Dict[str | Path, Sequence[tuple[float, float, float]]]</code> <p>Dictionary mapping receptor PDBQT files to their list of binding pocket centers.</p> required <code>ligands</code> <code>Sequence[str | Path]</code> <p>List of ligand PDBQT files.</p> required <code>grid_size</code> <code>tuple[int, int, int]</code> <p>Dimensions of the search box in \u00c5. Defaults to (20, 20, 20).</p> <code>(20, 20, 20)</code> <code>exhaustiveness</code> <code>int</code> <p>Sampling exhaustiveness. Higher values increase accuracy but also computation time. Defaults to 8.</p> <code>8</code> <code>num_modes</code> <code>int</code> <p>Maximum number of binding modes. Defaults to 9.</p> <code>9</code> <code>verbosity</code> <code>int</code> <p>Verbosity level (0 = quiet, 1 = normal, 2 = verbose). Defaults to 1.</p> <code>1</code> <code>seed</code> <code>int</code> <p>Random seed. If None, Vina selects automatically.</p> <code>None</code>"},{"location":"api/batch-vina/#docksuitex.batch_docking.batch_vina.BatchVinaDocking.run_all","title":"run_all","text":"<pre><code>run_all(\n    cpu: int = os.cpu_count() or 1,\n    save_to: Union[str, Path] = \"./batch_vina_results\",\n) -&gt; dict[\n    tuple[str, str, tuple[float, float, float]],\n    Union[Path, str],\n]\n</code></pre> <p>Run AutoDock Vina docking for all ligands \u00d7 all centers \u00d7 all receptors in parallel.</p> <p>Parameters:</p> Name Type Description Default <code>cpu</code> <code>int</code> <p>Total number of CPU cores to use. Defaults to all available cores. CPUs are divided among workers, with each worker receiving multiple CPUs for Vina.</p> <code>cpu_count() or 1</code> <code>save_to</code> <code>str | Path</code> <p>Directory where docking results will be stored. Defaults to \"./batch_vina_results\".</p> <code>'./batch_vina_results'</code> <p>Returns:</p> Type Description <code>dict[tuple[str, str, tuple[float, float, float]], Union[Path, str]]</code> <p>dict[tuple[str, str, tuple[float, float, float]], Path | str]: Mapping from (receptor_name, ligand_name, center) to: - Path: Path to the docking result file, if successful. - str: Error message if the docking failed.</p>"},{"location":"api/cleaner/","title":"Cleaner","text":""},{"location":"api/cleaner/#docksuitex.utils.cleaner","title":"docksuitex.utils.cleaner","text":""},{"location":"api/cleaner/#docksuitex.utils.cleaner.delete_binaries","title":"delete_binaries","text":"<pre><code>delete_binaries()\n</code></pre> <p>Delete the DockSuiteX binaries directory and all its contents.</p> <p>This function removes the entire <code>bin/</code> directory containing all bundled executables (MGLTools, AutoDock Vina, AutoDock4, P2Rank, Open Babel). Use this to clean up disk space or force a fresh download of binaries.</p> <p>The binaries will be automatically re-downloaded on the next import of DockSuiteX.</p> <p>Raises:</p> Type Description <code>PermissionError</code> <p>If the directory or files are in use or protected.</p> Warning <p>This will delete all binary executables. They will need to be re-downloaded (~500MB) on next import.</p> Example <p>::</p> <pre><code>from docksuitex.utils import delete_binaries\n\n# Remove all binaries\ndelete_binaries()\n\n# Binaries will be re-downloaded on next import\nimport docksuitex  # Triggers download\n</code></pre>"},{"location":"api/fetcher/","title":"Fetcher","text":""},{"location":"api/fetcher/#docksuitex.utils.fetcher","title":"docksuitex.utils.fetcher","text":"<p>Structure fetching from online databases.</p> <p>This module provides functions for downloading protein and ligand structures from public databases including RCSB PDB and PubChem. It automates the process of retrieving structures for docking studies.</p> The fetching functions handle <ul> <li>Protein structure download from RCSB PDB</li> <li>Ligand structure download from PubChem</li> <li>Batch downloading of multiple structures</li> <li>Automatic file naming and organization</li> </ul> Example <p>Fetching protein structures::</p> <pre><code>from docksuitex.utils import fetch_pdb\n\n# Download single protein\npdb_path = fetch_pdb(\"1UBQ\", save_to=\"structures\")\n\n# Download multiple proteins\npaths = fetch_pdb([\"1UBQ\", \"2HHB\", \"3CL0\"], save_to=\"proteins\")\n</code></pre> <p>Fetching ligand structures::</p> <pre><code>from docksuitex.utils import fetch_sdf\n\n# Download ligand from PubChem\nsdf_path = fetch_sdf(\"2244\", save_to=\"ligands\")  # Aspirin\n\n# Download multiple ligands\npaths = fetch_sdf([2244, 5090, 6323], save_to=\"ligands\")\n</code></pre> Note <p>These functions require an active internet connection and access to the respective databases. Rate limiting may apply for batch downloads.</p>"},{"location":"api/fetcher/#docksuitex.utils.fetcher.fetch_pdb","title":"fetch_pdb","text":"<pre><code>fetch_pdb(\n    pdbid: Union[str, List[str]],\n    save_to: Union[str, Path] = \".\",\n) -&gt; Union[Path, List[Path]]\n</code></pre> <p>Download PDB structure file(s) from the RCSB Protein Data Bank.</p> <p>This function downloads the <code>.pdb</code> file(s) corresponding to the given 4-character PDB ID(s).</p> <p>Parameters:</p> Name Type Description Default <code>pdbid</code> <code>str | List[str]</code> <p>The 4-character alphanumeric PDB ID (e.g., \"1UBQ\") or a list of PDB IDs.</p> required <code>save_to</code> <code>str | Path</code> <p>Directory to save the file(s). Defaults to the current directory.</p> <code>'.'</code> <p>Returns:</p> Type Description <code>Union[Path, List[Path]]</code> <p>Path | List[Path]: The absolute path(s) to the downloaded <code>.pdb</code> file(s).</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If <code>pdbid</code> is not a valid 4-character alphanumeric string.</p> <code>RequestException</code> <p>If the network request fails.</p> <code>RuntimeError</code> <p>If the PDB file cannot be retrieved (e.g., invalid ID).</p>"},{"location":"api/fetcher/#docksuitex.utils.fetcher.fetch_sdf","title":"fetch_sdf","text":"<pre><code>fetch_sdf(\n    cid: Union[str, int, List[Union[str, int]]],\n    save_to: Union[str, Path] = \".\",\n) -&gt; Union[Path, List[Path]]\n</code></pre> <p>Download 3D SDF structure file(s) from PubChem using Compound ID(s).</p> <p>This function downloads the <code>.sdf</code> file(s) corresponding to the given PubChem CID(s).</p> <p>Parameters:</p> Name Type Description Default <code>cid</code> <code>str | int | List[str | int]</code> <p>The numeric Compound ID (e.g., 2244 for Aspirin) or a list of CIDs.</p> required <code>save_to</code> <code>str | Path</code> <p>Directory to save the file(s). Defaults to the current directory.</p> <code>'.'</code> <p>Returns:</p> Type Description <code>Union[Path, List[Path]]</code> <p>Path | List[Path]: The absolute path(s) to the downloaded <code>.sdf</code> file(s).</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If <code>cid</code> is not a valid integer identifier.</p> <code>RequestException</code> <p>If the network request fails.</p> <code>RuntimeError</code> <p>If the SDF file cannot be retrieved or is empty.</p>"},{"location":"api/ligand/","title":"Ligand","text":""},{"location":"api/ligand/#docksuitex.ligand.Ligand","title":"docksuitex.ligand.Ligand","text":"<pre><code>Ligand(\n    input: Union[str, Path],\n    minimize: Optional[str] = None,\n    remove_water: bool = True,\n    add_hydrogens: bool = True,\n    add_charges: bool = True,\n    preserve_charge_types: Optional[list[str]] = None,\n)\n</code></pre> <p>Automated ligand structure preparation for molecular docking.</p> <p>This class provides a complete workflow for preparing ligand structures for docking simulations. It integrates Open Babel for format conversion and energy minimization, and AutoDockTools for PDBQT generation.</p> The preparation process handles <ul> <li>Format conversion from various structure formats to MOL2</li> <li>3D coordinate generation for 2D structures or SMILES</li> <li>Energy minimization with multiple forcefields</li> <li>Water molecule removal</li> <li>Hydrogen addition (polar or all)</li> <li>Gasteiger charge assignment</li> <li>PDBQT format conversion for docking</li> </ul> Example <p>Standard ligand preparation::</p> <pre><code>from docksuitex import Ligand\n\nligand = Ligand(\"compound.sdf\", minimize=\"mmff94\")\npdbqt_file = ligand.prepare(save_to=\"ligand.pdbqt\")\n</code></pre> <p>Preparation from SMILES::</p> <pre><code>ligand = Ligand(\"molecule.smi\", minimize=\"uff\")\npdbqt_file = ligand.prepare()\n</code></pre> Note <p>Temporary files are created in a <code>temp/Ligands/</code> directory and are not automatically cleaned up. The final PDBQT file is saved to the specified location.</p> <p>Initialize a Ligand object with a given input file and preparation parameters.</p> <p>Parameters:</p> Name Type Description Default <code>input</code> <code>str | Path</code> <p>Path to the ligand input file.</p> required <code>minimize</code> <code>str</code> <p>Forcefield for energy minimization (\"mmff94\", \"mmff94s\", \"uff\", \"gaff\").</p> <code>None</code> <code>remove_water</code> <code>bool</code> <p>Remove water molecules. Defaults to True.</p> <code>True</code> <code>add_hydrogens</code> <code>bool</code> <p>Add polar hydrogens. Defaults to True.</p> <code>True</code> <code>add_charges</code> <code>bool</code> <p>Assign Gasteiger charges. Defaults to True.</p> <code>True</code> <code>preserve_charge_types</code> <code>list[str]</code> <p>Atom types to preserve charges for. Defaults to None.</p> <code>None</code> <p>Raises:</p> Type Description <code>FileNotFoundError</code> <p>If the input file does not exist.</p> <code>ValueError</code> <p>If the file extension is unsupported.</p>"},{"location":"api/ligand/#docksuitex.ligand.Ligand.prepare","title":"prepare","text":"<pre><code>prepare(save_to: Union[str, Path] = '.') -&gt; Path\n</code></pre> <p>Prepare the ligand by converting to MOL2, optionally minimizing energy,  and generating a final PDBQT file using AutoDockTools (from MGLTools). Saves the prepared PDBQT file to the specified location.</p> <p>Parameters:</p> Name Type Description Default <code>save_to</code> <code>str | Path</code> <p>Destination file or directory. - If directory: saves with the original filename. - If file path: saves with the given name. Defaults to current directory.</p> <code>'.'</code> <p>Returns:</p> Name Type Description <code>Path</code> <code>Path</code> <p>Path to the saved PDBQT file.</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If an unsupported forcefield or input format is provided.</p> <code>RuntimeError</code> <p>If AutoDockTools fails to generate the PDBQT file.</p>"},{"location":"api/ligand/#docksuitex.ligand.Ligand.view_molecule","title":"view_molecule","text":"<pre><code>view_molecule()\n</code></pre> <p>Visualize the ligand structure in a Jupyter notebook.</p> <p>Uses nglview to render either the prepared or original file.</p> <p>Returns:</p> Name Type Description <code>object</code> <p>An nglview.NGLWidget object for rendering.</p> <p>Raises:</p> Type Description <code>FileNotFoundError</code> <p>If neither prepared nor input file exists.</p>"},{"location":"api/overview/","title":"API Overview","text":""},{"location":"api/overview/#project-structure","title":"Project Structure","text":"<p>The DockSuiteX package is organized into core modules, batch processing modules, and utility functions:</p> <pre><code>docksuitex/\n\u251c\u2500\u2500 protein.py          # Protein preparation (PDBFixer, Open Babel, AutoDockTools)\n\u251c\u2500\u2500 ligand.py           # Ligand preparation (Open Babel, minimization, AutoDockTools)\n\u251c\u2500\u2500 pocket_finder.py    # Pocket detection with P2Rank\n\u251c\u2500\u2500 autodock4.py        # AutoDock4 docking wrapper\n\u251c\u2500\u2500 vina.py             # AutoDock Vina docking wrapper\n\u251c\u2500\u2500 batch_autodock4.py  # Parallel batch docking with AutoDock4\n\u251c\u2500\u2500 batch_vina.py       # Parallel batch docking with AutoDock Vina\n\u251c\u2500\u2500 utils/\n\u2502   \u251c\u2500\u2500 fetcher.py      # Fetch PDB (RCSB) &amp; SDF (PubChem)\n\u2502   \u251c\u2500\u2500 viewer.py       # NGLView visualization\n\u2502   \u251c\u2500\u2500 parser.py       # Parse logs to CSV summaries\n\u2502   \u2514\u2500\u2500 cleaner.py      # Reset temp folders and delete bin folder\n\u2502\n\u2514\u2500\u2500 bin/                # Auto-downloaded on first run\n    \u251c\u2500\u2500 mgltools/       # MGLTools binaries and scripts\n    \u251c\u2500\u2500 obabel/         # Open Babel executables\n    \u251c\u2500\u2500 vina/           # AutoDock Vina executable (vina.exe)\n    \u251c\u2500\u2500 p2rank/         # P2Rank executable and scripts\n    \u2514\u2500\u2500 autodock/       # AutoDock4 &amp; AutoGrid executables\n</code></pre>"},{"location":"api/overview/#module-categories","title":"Module Categories","text":""},{"location":"api/overview/#core-modules","title":"Core Modules","text":"<p>Fundamental classes for molecular docking workflows:</p> <ul> <li>Protein - Protein structure preparation and conversion to PDBQT format</li> <li>Ligand - Ligand preparation with energy minimization options</li> <li>VinaDocking - AutoDock Vina docking interface</li> <li>AD4Docking - AutoDock4 docking interface</li> <li>PocketFinder - Binding pocket prediction using P2Rank</li> </ul>"},{"location":"api/overview/#batch-processing","title":"Batch Processing","text":"<p>High-throughput docking with parallel execution:</p> <ul> <li>BatchVinaDocking - Parallel Vina docking for multiple ligands and pockets</li> <li>BatchAD4Docking - Parallel AutoDock4 docking</li> <li>BatchProtein - Batch protein preparation</li> <li>BatchLigand - Batch ligand preparation</li> <li>BatchPocketFinder - Batch pocket prediction</li> </ul>"},{"location":"api/overview/#utilities","title":"Utilities","text":"<p>Helper functions for common tasks:</p> <ul> <li>Viewer - 3D molecular visualization with NGLView</li> <li>Parser - Parse docking logs to CSV format</li> <li>Fetcher - Download structures from RCSB PDB and PubChem</li> <li>Cleaner - Clean temporary files and manage binaries</li> </ul>"},{"location":"api/overview/#binary-dependencies","title":"Binary Dependencies","text":"<p>DockSuiteX automatically downloads and manages the following third-party tools:</p> Tool Purpose Location MGLTools Protein/ligand preparation scripts <code>bin/mgltools/</code> AutoDock Vina Fast gradient-based docking <code>bin/vina/</code> AutoDock4 Classic genetic algorithm docking <code>bin/autodock/</code> P2Rank Machine learning pocket prediction <code>bin/p2rank/</code> Open Babel Format conversion and minimization <code>bin/obabel/</code> <p>All binaries are downloaded from the DockSuiteX_Binaries repository on first import.</p>"},{"location":"api/parser/","title":"Parser","text":""},{"location":"api/parser/#docksuitex.utils.parser","title":"docksuitex.utils.parser","text":"<p>Docking output file parsing utilities.</p> <p>This module provides functions for parsing AutoDock Vina and AutoDock4 output files into structured CSV format for analysis. It extracts binding energies, grid parameters, and clustering information from log files.</p> The parsing functions handle <ul> <li>AutoDock Vina log file parsing (log.txt)</li> <li>AutoDock4 DLG file parsing (results.dlg)</li> <li>Recursive directory scanning for batch results</li> <li>CSV export with standardized columns</li> </ul> Example <p>Parsing Vina results::</p> <pre><code>from docksuitex.utils import parse_vina_log_to_csv\n\n# Parse all Vina results in directory\nparse_vina_log_to_csv(\n    results_dir=\"vina_docking_results\",\n    output_csv=\"vina_summary.csv\"\n)\n</code></pre> <p>Parsing AutoDock4 results::</p> <pre><code>from docksuitex.utils import parse_ad4_dlg_to_csv\n\n# Parse all AD4 results\nparse_ad4_dlg_to_csv(\n    results_dir=\"ad4_docking_results\",\n    output_csv=\"ad4_summary.csv\"\n)\n</code></pre> Note <p>The parsers expect standard output formats from AutoDock Vina and AutoDock4. Custom output formats may not be parsed correctly.</p>"},{"location":"api/parser/#docksuitex.utils.parser.parse_vina_log_to_csv","title":"parse_vina_log_to_csv","text":"<pre><code>parse_vina_log_to_csv(\n    results_dir: Union[str, Path],\n    output_csv: Union[str, Path] = \"vina_summary.csv\",\n) -&gt; pd.DataFrame\n</code></pre> <p>Parse AutoDock Vina log files into a structured CSV summary.</p> <p>This function scans a directory tree for Vina docking log files (<code>log.txt</code>), extracts receptor/ligand names, grid box parameters, and docking results (affinity and RMSD values), then writes the results to a CSV file.</p> <p>Parameters:</p> Name Type Description Default <code>results_dir</code> <code>str | Path</code> <p>Path to the directory containing docking result subfolders. Each folder should include a <code>log.txt</code> file from AutoDock Vina.</p> required <code>output_csv</code> <code>str | Path</code> <p>Path to save the generated CSV summary. Defaults to \"vina_summary.csv\" in the current directory.</p> <code>'vina_summary.csv'</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>pd.DataFrame: DataFrame containing parsed docking results with columns: - Receptor, Ligand - Mode, Affinity (kcal/mol), RMSD LB, RMSD UB - Grid Center (X, Y, Z), Grid Size (X, Y, Z), Grid Spacing - Exhaustiveness</p> <p>Raises:</p> Type Description <code>FileNotFoundError</code> <p>If no <code>log.txt</code> files are found under <code>results_dir</code>.</p> <code>RuntimeError</code> <p>If parsing fails or no docking results are extracted.</p>"},{"location":"api/parser/#docksuitex.utils.parser.parse_ad4_dlg_to_csv","title":"parse_ad4_dlg_to_csv","text":"<pre><code>parse_ad4_dlg_to_csv(\n    results_dir: Union[str, Path],\n    output_csv: Union[str, Path] = \"ad4_summary.csv\",\n) -&gt; pd.DataFrame\n</code></pre> <p>Parse AutoDock4 DLG result files into a structured CSV summary.</p> <p>This function scans a directory tree for AutoDock4 docking log files (<code>results.dlg</code>), extracts receptor and ligand names, grid box parameters, genetic algorithm (GA) settings, and cluster docking results, then writes them to a CSV file.</p> <p>Parameters:</p> Name Type Description Default <code>results_dir</code> <code>str | Path</code> <p>Path to the directory containing docking result subfolders. Each folder should include a <code>results.dlg</code> file from AutoDock4.</p> required <code>output_csv</code> <code>str | Path</code> <p>Path to save the generated CSV summary. Defaults to \"ad4_summary.csv\" in the current directory.</p> <code>'ad4_summary.csv'</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>pd.DataFrame: DataFrame containing parsed docking results with columns: - Receptor, Ligand - Cluster_Rank, RMSD, Binding_Energy - Grid Center (X, Y, Z), Grid Size (X, Y, Z), Spacing - GA parameters (e.g., rmstol, ga_pop_size, ga_num_evals, etc.)</p> <p>Raises:</p> Type Description <code>FileNotFoundError</code> <p>If no <code>results.dlg</code> files are found under <code>results_dir</code>.</p> <code>RuntimeError</code> <p>If parsing fails or cluster information cannot be extracted.</p>"},{"location":"api/pocket-finder/","title":"PocketFinder","text":""},{"location":"api/pocket-finder/#docksuitex.pocket_finder.PocketFinder","title":"docksuitex.pocket_finder.PocketFinder","text":"<pre><code>PocketFinder(\n    input: Union[str, Path], _cpu: int = os.cpu_count() or 1\n)\n</code></pre> <p>Ligand-binding pocket prediction using P2Rank.</p> <p>This class provides a wrapper for P2Rank, a machine learning-based tool for predicting ligand-binding sites in protein structures. It automates running P2Rank, parsing results, and extracting pocket center coordinates.</p> <p>P2Rank uses a template-free approach based on local chemical neighborhood features, making it fast and accurate for pocket prediction without requiring known ligand structures.</p> <p>Attributes:</p> Name Type Description <code>file_path</code> <code>Path</code> <p>Path to the input protein file (PDB or PDBQT).</p> Example <p>Finding pockets for docking::</p> <pre><code>from docksuitex import PocketFinder\n\nfinder = PocketFinder(\"protein.pdb\")\npockets = finder.run(save_to=\"pocket_analysis\")\n\n# Pockets are ranked by confidence\nfor i, pocket in enumerate(pockets):\n    rank = pocket[\"rank\"]\n    center = pocket[\"center\"]\n    print(f\"Pocket {rank}: center at {center}\")\n</code></pre> <p>Using pocket centers for batch docking::</p> <pre><code>finder = PocketFinder(\"receptor.pdbqt\")\npockets = finder.run()\ncenters = [p[\"center\"] for p in pockets[:3]]  # Top 3 pockets\n\n# Use centers for docking\nfor center in centers:\n    docking = VinaDocking(\n        receptor=\"receptor.pdbqt\",\n        ligand=\"ligand.pdbqt\",\n        grid_center=center\n    )\n    docking.run()\n</code></pre> Note <p>P2Rank generates multiple output files including visualizations and detailed predictions. The main CSV file is parsed to extract pocket center coordinates.</p> <p>Initialize the PocketFinder with a receptor structure.</p> <p>Parameters:</p> Name Type Description Default <code>input</code> <code>Union[str, Path]</code> <p>Path to a protein file in <code>.pdb</code> or <code>.pdbqt</code> format.</p> required <p>Raises:</p> Type Description <code>FileNotFoundError</code> <p>If the receptor file does not exist.</p> <code>ValueError</code> <p>If the file is not a supported format.</p>"},{"location":"api/pocket-finder/#docksuitex.pocket_finder.PocketFinder.run","title":"run","text":"<pre><code>run(\n    save_to: Union[str, Path] = None,\n) -&gt; List[\n    Dict[str, Union[int, Tuple[float, float, float]]]\n]\n</code></pre> <p>Execute P2Rank to predict ligand-binding pockets.</p> <p>Parameters:</p> Name Type Description Default <code>save_to</code> <code>Union[str, Path]</code> <p>Directory to save the P2Rank report.  Defaults to \".\".</p> <code>None</code> <p>Returns:</p> Type Description <code>List[Dict[str, Union[int, Tuple[float, float, float]]]]</code> <p>List[Dict[str, Union[int, Tuple[float, float, float]]]]: A list of pocket predictions, where each dictionary contains: - <code>rank</code> (int): Pocket ranking by confidence. - <code>center</code> (tuple[float, float, float]): (x, y, z) coordinates of the pocket center.</p> <p>Raises:</p> Type Description <code>RuntimeError</code> <p>If P2Rank fails to run.</p>"},{"location":"api/protein/","title":"Protein","text":""},{"location":"api/protein/#docksuitex.protein.Protein","title":"docksuitex.protein.Protein","text":"<pre><code>Protein(\n    input: Union[str, Path],\n    fix_pdb: bool = True,\n    remove_heterogens: bool = True,\n    add_hydrogens: bool = True,\n    remove_water: bool = True,\n    add_charges: bool = True,\n    preserve_charge_types: Optional[list[str]] = None,\n)\n</code></pre> <p>Automated protein structure preparation for molecular docking.</p> <p>This class provides a complete workflow for preparing protein structures for docking simulations. It integrates PDBFixer for structure repair, Open Babel for format conversion, and AutoDockTools for PDBQT generation.</p> The preparation process handles <ul> <li>Format conversion from various structure formats to PDB</li> <li>Missing residue and atom reconstruction</li> <li>Nonstandard residue replacement</li> <li>Heteroatom and water molecule removal</li> <li>Hydrogen addition (polar or all)</li> <li>Gasteiger charge assignment</li> <li>PDBQT format conversion for docking</li> </ul> Example <p>Standard protein preparation::</p> <pre><code>from docksuitex import Protein\n\nprotein = Protein(\"1abc.pdb\", fix_pdb=True)\npdbqt_file = protein.prepare(save_to=\"receptor.pdbqt\")\n</code></pre> <p>Preparation with metal ion charge preservation::</p> <pre><code>protein = Protein(\n    \"metalloprotein.pdb\",\n    preserve_charge_types=[\"Zn\", \"Fe\", \"Ca\"]\n)\npdbqt_file = protein.prepare()\n</code></pre> Note <p>Temporary files are created in a <code>temp/Proteins/</code> directory and are not automatically cleaned up. The final PDBQT file is saved to the specified location.</p> <p>Initialize a Protein object with a given file path and preparation parameters.</p> <p>Parameters:</p> Name Type Description Default <code>input</code> <code>str | Path</code> <p>Path to the protein input file.</p> required <code>fix_pdb</code> <code>bool</code> <p>Fix missing residues/atoms using PDBFixer. Defaults to True.</p> <code>True</code> <code>remove_heterogens</code> <code>bool</code> <p>Remove ligands/heterogens. Defaults to True.</p> <code>True</code> <code>add_hydrogens</code> <code>bool</code> <p>Add hydrogens. Defaults to True.</p> <code>True</code> <code>remove_water</code> <code>bool</code> <p>Remove water molecules. Defaults to True.</p> <code>True</code> <code>add_charges</code> <code>bool</code> <p>Assign Gasteiger charges. Defaults to True.</p> <code>True</code> <code>preserve_charge_types</code> <code>list[str]</code> <p>Atom types to preserve charges for. Defaults to None.</p> <code>None</code> <p>Raises:</p> Type Description <code>FileNotFoundError</code> <p>If the provided file does not exist.</p> <code>ValueError</code> <p>If the file format is not supported.</p> Source code in <code>docksuitex\\protein.py</code> <pre><code>def __init__(\n    self,\n    input: Union[str, Path],\n    fix_pdb: bool = True,\n    remove_heterogens: bool = True,\n    add_hydrogens: bool = True,\n    remove_water: bool = True,\n    add_charges: bool = True,\n    preserve_charge_types: Optional[list[str]] = None,\n):\n    \"\"\"Initialize a Protein object with a given file path and preparation parameters.\n\n    Args:\n        input (str | Path): Path to the protein input file.\n        fix_pdb (bool, optional): Fix missing residues/atoms using PDBFixer. Defaults to True.\n        remove_heterogens (bool, optional): Remove ligands/heterogens. Defaults to True.\n        add_hydrogens (bool, optional): Add hydrogens. Defaults to True.\n        remove_water (bool, optional): Remove water molecules. Defaults to True.\n        add_charges (bool, optional): Assign Gasteiger charges. Defaults to True.\n        preserve_charge_types (list[str], optional): Atom types to preserve charges for. Defaults to None.\n\n    Raises:\n        FileNotFoundError: If the provided file does not exist.\n        ValueError: If the file format is not supported.\n    \"\"\"\n    self.file_path = Path(input).resolve()\n    self.pdb_path: Optional[Path] = None\n    self.fixed_pdb_path: Optional[Path] = None\n    self.pdbqt_path: Optional[Path] = None\n\n    if not self.file_path.is_file():\n        raise FileNotFoundError(\n            f\"\u274c Protein file not found: {self.file_path}\")\n\n    self.ext = self.file_path.suffix.lower()\n    if self.ext not in self.SUPPORTED_INPUTS:\n        raise ValueError(\n            f\"\u274c Unsupported file format '{self.ext}'. Supported formats: {self.SUPPORTED_INPUTS}\")\n\n    # Store preparation parameters\n    self.fix_pdb = fix_pdb\n    self.remove_heterogens = remove_heterogens\n    self.add_hydrogens = add_hydrogens\n    self.remove_water = remove_water\n    self.add_charges = add_charges\n    self.preserve_charge_types = preserve_charge_types\n</code></pre>"},{"location":"api/protein/#docksuitex.protein.Protein.prepare","title":"prepare","text":"<pre><code>prepare(save_to: Union[str, Path] = '.') -&gt; Path\n</code></pre> <p>Handles protein preparation for docking using PDBFixer, Open Babel, and AutoDockTools (ADT). Saves the prepared PDBQT file to the specified location.</p> <p>Parameters:</p> Name Type Description Default <code>save_to</code> <code>str | Path</code> <p>Destination path for the PDBQT file. - If a directory: file will be saved with original name. - If a file path: saved with the given name. Defaults to current directory.</p> <code>'.'</code> <p>Returns:</p> Name Type Description <code>Path</code> <code>Path</code> <p>Path to the saved PDBQT file.</p> <p>Raises:</p> Type Description <code>RuntimeError</code> <p>If Open Babel or AutoDockTools commands fail.</p> Source code in <code>docksuitex\\protein.py</code> <pre><code>def prepare(self, save_to: Union[str, Path] = \".\") -&gt; Path:\n    \"\"\"\n    Handles protein preparation for docking using PDBFixer, Open Babel, and AutoDockTools (ADT).\n    Saves the prepared PDBQT file to the specified location.\n\n    Args:\n        save_to (str | Path, optional): Destination path for the PDBQT file.\n            - If a directory: file will be saved with original name.\n            - If a file path: saved with the given name.\n            Defaults to current directory.\n\n    Returns:\n        Path: Path to the saved PDBQT file.\n\n    Raises:\n        RuntimeError: If Open Babel or AutoDockTools commands fail.\n    \"\"\"\n    # Create a unique temp directory per object\n    self.temp_dir = TEMP_DIR / \"Proteins\" / f\"{self.file_path.stem}_{uuid.uuid4().hex[:8]}\"\n    self.temp_dir.mkdir(parents=True, exist_ok=True)\n\n    # Convert to .pdb if needed\n    if self.ext != \".pdb\":\n        self.pdb_path = self.temp_dir / f\"{self.file_path.stem}.pdb\"\n        cmd = [str(OBABEL_EXE), str(self.file_path),\"-O\", str(self.pdb_path), \"--gen3d\"]\n        result = subprocess.run(cmd, capture_output=True, text=True)\n        if result.returncode != 0:\n            raise PreparationError(f\"Open Babel conversion failed:\\n{result.stderr}\")\n\n    else:\n        self.pdb_path = self.file_path\n\n    # Fix structure using PDBFixer\n    fixer = PDBFixer(filename=str(self.pdb_path))\n    if self.fix_pdb:\n        fixer.findMissingResidues()\n        fixer.findNonstandardResidues()\n        fixer.replaceNonstandardResidues()\n        fixer.findMissingAtoms()\n        fixer.addMissingAtoms()\n    if self.remove_heterogens:\n        fixer.removeHeterogens(keepWater=True)\n\n\n    # Save fixed PDB\n    fixed_pdb_path = self.temp_dir / f\"{self.file_path.stem}_fixed.pdb\"\n    with open(fixed_pdb_path, \"w\") as f:\n        PDBFile.writeFile(fixer.topology, fixer.positions, f)\n\n    self.fixed_pdb_path = fixed_pdb_path\n\n\n\n    # Convert to PDBQT using AutoDockTools\n    save_to = Path(save_to).expanduser().resolve()\n\n    # treat as file only if it has a suffix (e.g., .pdbqt)\n    if not save_to.suffix:\n        save_to = save_to / f\"{self.file_path.stem}.pdbqt\"\n\n    save_to.parent.mkdir(parents=True, exist_ok=True)\n\n    U_flag = \"nphs_lps_waters\" if self.remove_water else \"nphs_lps\"\n    cmd = [\n        str(MGL_PYTHON_EXE),\n        str(PREPARE_RECEPTOR_SCRIPT),\n        \"-r\", str(self.fixed_pdb_path),\n        \"-o\", str(save_to),\n        \"-U\", U_flag\n    ]\n    if self.add_hydrogens:\n        cmd += [\"-A\", \"hydrogens\"]\n\n    # Control charges\n    if not self.add_charges:\n        cmd += [\"-C\"]  # disable Gasteiger charges\n    elif self.preserve_charge_types:\n        for atom in self.preserve_charge_types:\n            cmd += [\"-p\", atom]\n\n    result = subprocess.run(cmd, capture_output=True, text=True)\n    if result.returncode != 0:\n        raise RuntimeError(f\"\u274c Error preparing PDBQT:\\n{result.stderr}\")\n\n    self.pdbqt_path = save_to\n\n    # # Save logic (merged from save_pdbqt)\n    # save_to = Path(save_to).expanduser().resolve()\n\n    # # treat as file only if it has a suffix (e.g., .pdbqt)\n    # if not save_to.suffix:\n    #     save_to = save_to / self.pdbqt_path.name\n\n    # save_to.parent.mkdir(parents=True, exist_ok=True)\n    # shutil.copy2(self.pdbqt_path, save_to)\n    print(f\"\u2705 Protein prepared successfully: {self.pdbqt_path}\")\n    return self.pdbqt_path\n</code></pre>"},{"location":"api/protein/#docksuitex.protein.Protein.view_molecule","title":"view_molecule","text":"<pre><code>view_molecule()\n</code></pre> <p>Visualize the protein structure in a Jupyter notebook.</p> <p>Uses NGLView to render either the prepared PDBQT file or the original input file in an interactive 3D viewer.</p> <p>Returns:</p> Type Description <p>nglview.NGLWidget: Interactive 3D molecular viewer widget.</p> <p>Raises:</p> Type Description <code>FileNotFoundError</code> <p>If neither prepared nor input file exists.</p> <code>ImportError</code> <p>If nglview is not installed.</p> Note <p>This method requires a Jupyter Notebook/Lab environment and the nglview package.</p> Example <p>::</p> <pre><code>protein = Protein(\"protein.pdb\")\nprotein.prepare()\nprotein.view_molecule()  # Opens 3D viewer\n</code></pre> Source code in <code>docksuitex\\protein.py</code> <pre><code>def view_molecule(self):\n    \"\"\"Visualize the protein structure in a Jupyter notebook.\n\n    Uses NGLView to render either the prepared PDBQT file or the original\n    input file in an interactive 3D viewer.\n\n    Returns:\n        nglview.NGLWidget: Interactive 3D molecular viewer widget.\n\n    Raises:\n        FileNotFoundError: If neither prepared nor input file exists.\n        ImportError: If nglview is not installed.\n\n    Note:\n        This method requires a Jupyter Notebook/Lab environment and the\n        nglview package.\n\n    Example:\n        ::\n\n            protein = Protein(\"protein.pdb\")\n            protein.prepare()\n            protein.view_molecule()  # Opens 3D viewer\n    \"\"\"\n    path = Path(self.pdbqt_path if self.pdbqt_path else self.file_path).resolve()\n    return view_molecule(file_path=path)\n</code></pre>"},{"location":"api/viewer/","title":"Viewer","text":""},{"location":"api/viewer/#docksuitex.utils.viewer","title":"docksuitex.utils.viewer","text":"<p>3D molecular visualization using NGLView.</p> <p>This module provides functions for visualizing molecular structures and docking results in Jupyter Notebook environments using NGLView. It supports interactive 3D rendering of proteins, ligands, and docking poses.</p> The visualization functions handle <ul> <li>Single molecule rendering (proteins or ligands)</li> <li>Multi-pose docking result visualization with interactive controls</li> <li>Automatic pose navigation and animation</li> <li>Customizable representation styles</li> </ul> Example <p>Visualizing a single molecule::</p> <pre><code>from docksuitex.utils import view_molecule\n\n# View protein structure\nview_molecule(\"protein.pdb\")\n\n# View ligand\nview_molecule(\"ligand.mol2\")\n</code></pre> <p>Viewing docking results::</p> <pre><code>from docksuitex.utils import view_results\n\n# Interactive viewer with pose controls\nview_results(\n    protein_file=\"receptor.pdbqt\",\n    ligand_file=\"docked_output.pdbqt\"\n)\n</code></pre> Note <p>These functions require a Jupyter Notebook/Lab environment and the nglview package. They will not work in standard Python scripts.</p>"},{"location":"api/viewer/#docksuitex.utils.viewer.view_molecule","title":"view_molecule","text":"<pre><code>view_molecule(file_path: str | Path) -&gt; nv.NGLWidget\n</code></pre> <p>Renders a molecular structure in Jupyter Notebook using NGLView.</p> <p>Parameters:</p> Name Type Description Default <code>file_path</code> <code>str</code> <p>Path to the molecular file (.pdb, .pdbqt, .mol2, or .sdf).</p> required <p>Returns:</p> Type Description <code>NGLWidget</code> <p>nv.NGLWidget: An NGLView widget.</p> <p>Raises:</p> Type Description <code>FileNotFoundError</code> <p>If the specified file does not exist.</p>"},{"location":"api/viewer/#docksuitex.utils.viewer.view_results","title":"view_results","text":"<pre><code>view_results(\n    protein_file: str | Path, ligand_file: str | Path\n) -&gt; None\n</code></pre> <p>Visualize docking results (multiple poses) of a ligand with a protein using NGLView and interactive Jupyter widgets.</p> Features <ul> <li>Step through individual docking poses.</li> <li>Toggle between showing one pose at a time or all poses simultaneously.</li> <li>Play/Pause automatic animation of poses.</li> <li>Adjust animation speed with a slider.</li> </ul> <p>Parameters:</p> Name Type Description Default <code>protein_file</code> <code>str | Path</code> <p>Path to the receptor protein file (e.g., .pdb).</p> required <code>ligand_file</code> <code>str | Path</code> <p>Path to the ligand docking results file (.pdbqt). The file should contain multiple docking poses in MODEL/ENDMDL blocks.</p> required <p>Returns:</p> Name Type Description <code>None</code> <code>None</code> <p>Displays the visualization and interactive controls directly</p> <code>None</code> <p>in the Jupyter Notebook.</p> <p>Raises:</p> Type Description <code>FileNotFoundError</code> <p>If the protein or ligand file does not exist.</p> <code>ValueError</code> <p>If the ligand file does not contain valid MODEL/ENDMDL blocks.</p>"},{"location":"api/vina/","title":"VinaDocking","text":""},{"location":"api/vina/#docksuitex.vina.VinaDocking","title":"docksuitex.vina.VinaDocking","text":"<pre><code>VinaDocking(\n    receptor: Union[str, Path, Protein],\n    ligand: Union[str, Path, Ligand],\n    grid_center: tuple[float, float, float],\n    grid_size: tuple[int, int, int] = (20, 20, 20),\n    exhaustiveness: int = 8,\n    num_modes: int = 9,\n    verbosity: int = 1,\n    seed: Optional[int] = None,\n    _cpu: int = os.cpu_count() or 1,\n)\n</code></pre> <p>Python wrapper for AutoDock Vina molecular docking.</p> <p>This class provides a high-level interface to AutoDock Vina, handling parameter validation, command execution, result management, and visualization. It automates the docking workflow from input validation to result generation.</p> <p>The class validates input files, constructs appropriate command-line arguments, executes Vina, captures output, and organizes results in a structured directory.</p> Example <p>Typical docking workflow::</p> <pre><code>from docksuitex import VinaDocking\n\n# Create docking instance\ndocking = VinaDocking(\n    receptor=\"prepared_receptor.pdbqt\",\n    ligand=\"prepared_ligand.pdbqt\",\n    grid_center=(25.0, 30.0, 15.0),\n    grid_size=(25, 25, 25),\n    exhaustiveness=16,\n    num_modes=20\n)\n\n# Execute docking\noutput_path = docking.run(save_to=\"vina_results\")\n\n# View results interactively\ndocking.view_results()\n</code></pre> Note <p>Grid center coordinates should be determined from binding pocket prediction (e.g., using PocketFinder) or known binding site information.</p> <p>Initialize a Vina docking job.</p> <p>Parameters:</p> Name Type Description Default <code>receptor</code> <code>Union[str, Path, Protein]</code> <p>Path to receptor PDBQT file. Must be a prepared protein structure in PDBQT format.</p> required <code>ligand</code> <code>Union[str, Path, Ligand]</code> <p>Path to ligand PDBQT file. Must be a prepared ligand structure in PDBQT format.</p> required <code>grid_center</code> <code>tuple[float, float, float]</code> <p>Grid box center coordinates (x, y, z) in Angstroms. Defines the center of the search space.</p> required <code>grid_size</code> <code>tuple[int, int, int]</code> <p>Grid box dimensions (x, y, z) in Angstroms. Defines the size of the search space. Defaults to (20, 20, 20).</p> <code>(20, 20, 20)</code> <code>exhaustiveness</code> <code>int</code> <p>Search exhaustiveness parameter. Higher values increase accuracy but also computation time. Typical range: 1-32. Defaults to 8.</p> <code>8</code> <code>num_modes</code> <code>int</code> <p>Maximum number of binding modes to generate. Vina will output up to this many poses ranked by predicted affinity. Defaults to 9.</p> <code>9</code> <code>verbosity</code> <code>int</code> <p>Output verbosity level. 0 = quiet, 1 = normal, 2 = verbose. Defaults to 1.</p> <code>1</code> <code>seed</code> <code>Optional[int]</code> <p>Random seed for reproducibility. If None, Vina uses a random seed. Defaults to None.</p> <code>None</code> <p>Raises:</p> Type Description <code>FileNotFoundError</code> <p>If receptor or ligand file does not exist.</p> <code>ValueError</code> <p>If input files are not PDBQT format or grid parameters are invalid (wrong tuple size or non-numeric values).</p> <code>TypeError</code> <p>If grid_center or grid_size contain non-numeric values.</p> Source code in <code>docksuitex\\vina.py</code> <pre><code>def __init__(\n    self,\n    receptor: Union[str, Path, \"Protein\"],\n    ligand: Union[str, Path, \"Ligand\"],\n    grid_center: tuple[float, float, float],\n    grid_size: tuple[int, int, int] = (20, 20, 20),\n    exhaustiveness: int = 8,\n    num_modes: int = 9,\n    verbosity: int = 1,\n    seed: Optional[int] = None,\n\n    _cpu: int = os.cpu_count() or 1,\n):\n    \"\"\"Initialize a Vina docking job.\n\n    Args:\n        receptor (Union[str, Path, Protein]): Path to receptor PDBQT file.\n            Must be a prepared protein structure in PDBQT format.\n        ligand (Union[str, Path, Ligand]): Path to ligand PDBQT file.\n            Must be a prepared ligand structure in PDBQT format.\n        grid_center (tuple[float, float, float]): Grid box center coordinates\n            (x, y, z) in Angstroms. Defines the center of the search space.\n        grid_size (tuple[int, int, int], optional): Grid box dimensions\n            (x, y, z) in Angstroms. Defines the size of the search space.\n            Defaults to (20, 20, 20).\n        exhaustiveness (int, optional): Search exhaustiveness parameter.\n            Higher values increase accuracy but also computation time.\n            Typical range: 1-32. Defaults to 8.\n        num_modes (int, optional): Maximum number of binding modes to generate.\n            Vina will output up to this many poses ranked by predicted affinity.\n            Defaults to 9.\n        verbosity (int, optional): Output verbosity level.\n            0 = quiet, 1 = normal, 2 = verbose. Defaults to 1.\n        seed (Optional[int], optional): Random seed for reproducibility.\n            If None, Vina uses a random seed. Defaults to None.\n\n    Raises:\n        FileNotFoundError: If receptor or ligand file does not exist.\n        ValueError: If input files are not PDBQT format or grid parameters\n            are invalid (wrong tuple size or non-numeric values).\n        TypeError: If grid_center or grid_size contain non-numeric values.\n    \"\"\"\n\n    self.receptor = Path(receptor).resolve()\n    self.ligand = Path(ligand).resolve()\n\n    if not self.receptor.is_file():\n        raise FileNotFoundError(\n            f\"\u274c Receptor file not found: {self.receptor}\")\n    if not self.ligand.is_file():\n        raise FileNotFoundError(f\"\u274c Ligand file not found: {self.ligand}\")\n\n    if self.receptor.suffix.lower() != \".pdbqt\":\n        raise ValueError(\"\u26a0\ufe0f Receptor must be a .pdbqt file.\")\n    if self.ligand.suffix.lower() != \".pdbqt\":\n        raise ValueError(\"\u26a0\ufe0f Ligand must be a .pdbqt file.\")\n\n    if not (isinstance(grid_center, tuple) and len(grid_center) == 3):\n        raise ValueError(\"\u26a0\ufe0f 'grid_center' must be a 3-tuple of floats.\")\n    if not (isinstance(grid_size, tuple) and len(grid_size) == 3):\n        raise ValueError(\"\u26a0\ufe0f 'grid_size' must be a 3-tuple of floats.\")\n    if any(not isinstance(v, (float, int)) for v in grid_center + grid_size):\n        raise TypeError(\n            \"\u26a0\ufe0f Grid grid_center and grid_size values must be float or int.\")\n\n    self.grid_center = grid_center\n    self.grid_size = grid_size\n    self.exhaustiveness = exhaustiveness\n    self.num_modes = num_modes\n    self.cpu = _cpu\n    self.seed = seed\n    self.verbosity = verbosity\n</code></pre>"},{"location":"api/vina/#docksuitex.vina.VinaDocking.run","title":"run","text":"<pre><code>run(save_to: Union[str, Path] = None) -&gt; Path\n</code></pre> <p>Execute AutoDock Vina docking simulation.</p> <p>Runs the Vina docking calculation with the configured parameters, saves results to the specified directory, and generates output files including docked poses and a log file with binding energies.</p> <p>The method copies input files to the output directory, constructs the Vina command line, executes the docking, and validates the results.</p> <p>Parameters:</p> Name Type Description Default <code>save_to</code> <code>Union[str, Path]</code> <p>Directory path where docking results will be saved. If None, creates a directory named \"vina_docked_{receptor}_{ligand}\" in the current directory. Defaults to None.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>Path</code> <code>Path</code> <p>Absolute path to the output directory containing: - Receptor and ligand PDBQT files (copies of inputs) - output.pdbqt: Docked ligand poses ranked by affinity - log.txt: Vina output log with binding energies and RMSD values</p> <p>Raises:</p> Type Description <code>RuntimeError</code> <p>If Vina execution fails (non-zero return code) or if expected output files (output.pdbqt, log.txt) are not created.</p> Example <p>::</p> <pre><code>docking = VinaDocking(\n    receptor=\"protein.pdbqt\",\n    ligand=\"ligand.pdbqt\",\n    grid_center=(10.0, 15.0, 20.0)\n)\nresults_path = docking.run(save_to=\"my_results\")\nprint(f\"Results saved to: {results_path}\")\n</code></pre> Source code in <code>docksuitex\\vina.py</code> <pre><code>def run(self, save_to: Union[str, Path] = None) -&gt; Path:\n    \"\"\"Execute AutoDock Vina docking simulation.\n\n    Runs the Vina docking calculation with the configured parameters,\n    saves results to the specified directory, and generates output files\n    including docked poses and a log file with binding energies.\n\n    The method copies input files to the output directory, constructs the\n    Vina command line, executes the docking, and validates the results.\n\n    Args:\n        save_to (Union[str, Path], optional): Directory path where docking\n            results will be saved. If None, creates a directory named\n            \"vina_docked_{receptor}_{ligand}\" in the current directory.\n            Defaults to None.\n\n    Returns:\n        Path: Absolute path to the output directory containing:\n            - Receptor and ligand PDBQT files (copies of inputs)\n            - output.pdbqt: Docked ligand poses ranked by affinity\n            - log.txt: Vina output log with binding energies and RMSD values\n\n    Raises:\n        RuntimeError: If Vina execution fails (non-zero return code) or\n            if expected output files (output.pdbqt, log.txt) are not created.\n\n    Example:\n        ::\n\n            docking = VinaDocking(\n                receptor=\"protein.pdbqt\",\n                ligand=\"ligand.pdbqt\",\n                grid_center=(10.0, 15.0, 20.0)\n            )\n            results_path = docking.run(save_to=\"my_results\")\n            print(f\"Results saved to: {results_path}\")\n    \"\"\"\n\n    if save_to is None:\n        save_to = f\"vina_docked_{self.receptor.stem}_{self.ligand.stem}\"\n    self.output_dir = Path(save_to).resolve()\n    self.output_dir.mkdir(parents=True, exist_ok=True)\n\n    shutil.copy2(self.receptor, self.output_dir / self.receptor.name)\n    shutil.copy2(self.ligand, self.output_dir / self.ligand.name)\n\n    self.receptor = self.output_dir / self.receptor.name\n    self.ligand = self.output_dir / self.ligand.name\n\n    # Output files\n    self.output_pdbqt = self.output_dir / f\"output.pdbqt\"\n    self.output_log = self.output_dir / f\"log.txt\"\n\n    self._vina_output: Optional[str] = None\n\n    cmd = [\n        str(VINA_PATH),\n        \"--receptor\", str(self.receptor),\n        \"--ligand\", str(self.ligand),\n        \"--center_x\", str(self.grid_center[0]),\n        \"--center_y\", str(self.grid_center[1]),\n        \"--center_z\", str(self.grid_center[2]),\n        \"--size_x\", str(self.grid_size[0]),\n        \"--size_y\", str(self.grid_size[1]),\n        \"--size_z\", str(self.grid_size[2]),\n        \"--out\", str(self.output_pdbqt),\n        \"--exhaustiveness\", str(self.exhaustiveness),\n        \"--num_modes\", str(self.num_modes),\n        \"--cpu\", str(self.cpu),\n        \"--verbosity\", str(self.verbosity),\n    ]\n\n    if self.seed is not None:\n        cmd += [\"--seed\", str(self.seed)]\n\n    result = subprocess.run(cmd, capture_output=True, text=True)\n    if result.returncode != 0:\n        raise RuntimeError(f\"\u274c Error running AutoDock Vina:\\n{result.stderr}\")\n\n    self._vina_output = result.stdout\n\n    if self._vina_output:\n        with open(self.output_log, \"w\") as log_file:\n            log_file.write(self._vina_output)\n\n    # Check if results exist before proceeding\n    if not self.output_pdbqt.exists() or not self.output_log.exists():\n        raise RuntimeError(\n            \"\u274c Docking results are missing. Check log.txt for details.\"\n        )\n\n    print(f\"\u2705 Vina docking completed. Results saved to: {self.output_dir}\")\n    return self.output_dir\n</code></pre>"},{"location":"api/vina/#docksuitex.vina.VinaDocking.view_results","title":"view_results","text":"<pre><code>view_results()\n</code></pre> <p>Visualize docking results using NGLView in Jupyter Notebook.</p> <p>Creates an interactive 3D visualization of the receptor-ligand complex with controls to browse through different docking poses. This method requires a Jupyter Notebook environment and the nglview package.</p> The visualization includes <ul> <li>Receptor structure displayed as cartoon representation</li> <li>Ligand poses displayed as ball-and-stick models</li> <li>Interactive controls to step through poses</li> <li>Play/pause animation of poses</li> <li>Speed control slider</li> </ul> <p>Returns:</p> Name Type Description <code>None</code> <p>Displays the interactive widget directly in the notebook.</p> <p>Raises:</p> Type Description <code>AttributeError</code> <p>If run() has not been called yet (output files not set).</p> <code>FileNotFoundError</code> <p>If output files have been deleted or moved.</p> <code>ImportError</code> <p>If nglview is not installed.</p> Note <p>This method must be called after run() to ensure output files exist. It only works in Jupyter Notebook/Lab environments.</p> Example <p>::</p> <pre><code>docking = VinaDocking(\n    receptor=\"protein.pdbqt\",\n    ligand=\"ligand.pdbqt\",\n    grid_center=(10.0, 15.0, 20.0)\n)\ndocking.run()\ndocking.view_results()  # Opens interactive 3D viewer\n</code></pre> Source code in <code>docksuitex\\vina.py</code> <pre><code>def view_results(self):\n    \"\"\"Visualize docking results using NGLView in Jupyter Notebook.\n\n    Creates an interactive 3D visualization of the receptor-ligand complex\n    with controls to browse through different docking poses. This method\n    requires a Jupyter Notebook environment and the nglview package.\n\n    The visualization includes:\n        - Receptor structure displayed as cartoon representation\n        - Ligand poses displayed as ball-and-stick models\n        - Interactive controls to step through poses\n        - Play/pause animation of poses\n        - Speed control slider\n\n    Returns:\n        None: Displays the interactive widget directly in the notebook.\n\n    Raises:\n        AttributeError: If run() has not been called yet (output files not set).\n        FileNotFoundError: If output files have been deleted or moved.\n        ImportError: If nglview is not installed.\n\n    Note:\n        This method must be called after run() to ensure output files exist.\n        It only works in Jupyter Notebook/Lab environments.\n\n    Example:\n        ::\n\n            docking = VinaDocking(\n                receptor=\"protein.pdbqt\",\n                ligand=\"ligand.pdbqt\",\n                grid_center=(10.0, 15.0, 20.0)\n            )\n            docking.run()\n            docking.view_results()  # Opens interactive 3D viewer\n    \"\"\"\n    view_results(protein_file=self.receptor, ligand_file=self.output_pdbqt)\n</code></pre>"},{"location":"getting-started/examples/","title":"Examples","text":"<p>Comprehensive examples demonstrating all major features of DockSuiteX.</p>"},{"location":"getting-started/examples/#protein-preparation","title":"Protein Preparation","text":"<p>Prepare a protein structure for docking:</p> <pre><code>from docksuitex import Protein\n\n# Load protein\nprot = Protein(\"protein.pdb\")\n\n# Prepare protein for docking\nprot.prepare(\n    fix_pdb=True,\n    remove_heterogens=True,\n    remove_water=True,\n    add_hydrogens=True,\n    add_charges=True\n)\n\n# Save the final PDBQT file\nprot.save_pdbqt(\"protein_prepared.pdbqt\")\n\n# Visualize protein (in Jupyter Notebook)\nprot.view()\n</code></pre>"},{"location":"getting-started/examples/#preserving-specific-charge-types","title":"Preserving Specific Charge Types","text":"<p>If your protein contains metal ions or other atoms whose charges should be preserved:</p> <pre><code>prot.prepare(\n    add_charges=True,\n    preserve_charge_types=[\"Zn\", \"Fe\", \"Mg\"]  # Preserve charges for these atoms\n)\n</code></pre>"},{"location":"getting-started/examples/#ligand-preparation","title":"Ligand Preparation","text":"<p>Prepare a ligand with energy minimization:</p> <pre><code>from docksuitex import Ligand\n\n# Load ligand\nlig = Ligand(\"ligand.sdf\")\n\n# Prepare ligand with MMFF94 minimization\nlig.prepare(\n    minimize=\"mmff94\",  # Options: \"mmff94\", \"mmff94s\", \"uff\", \"gaff\", or None\n    remove_water=True,\n    add_hydrogens=True,\n    add_charges=True\n)\n\n# Save the final PDBQT file\nlig.save_pdbqt(\"ligand_prepared.pdbqt\")\n\n# Visualize ligand (in Jupyter Notebook)\nlig.view()\n</code></pre>"},{"location":"getting-started/examples/#pocket-detection","title":"Pocket Detection","text":"<p>Predict binding sites using P2Rank:</p> <pre><code>from docksuitex import PocketFinder\n\n# Initialize pocket finder\npf = PocketFinder(\"protein.pdb\")\n\n# Run P2Rank to predict pockets\npockets = pf.run()\n\n# Display predicted pockets\nfor pocket in pockets:\n    print(f\"Rank {pocket['rank']}: Center at {pocket['center']}\")\n\n# Save full P2Rank output folder\npf.save_report(\"p2rank_report\")\n</code></pre>"},{"location":"getting-started/examples/#autodock-vina-docking","title":"AutoDock Vina Docking","text":""},{"location":"getting-started/examples/#basic-vina-docking","title":"Basic Vina Docking","text":"<pre><code>from docksuitex import VinaDocking\n\n# Initialize Vina docking\nvina = VinaDocking(\n    receptor=\"protein_prepared.pdbqt\",\n    ligand=\"ligand_prepared.pdbqt\",\n    grid_center=(10.0, 12.5, 8.0),\n    grid_size=(20, 20, 20),\n    exhaustiveness=8,\n    num_modes=9\n)\n\n# Run docking\nvina.run()\n\n# Visualize results (in Jupyter Notebook)\nvina.view_results()\n\n# Save results\nvina.save_results(\"vina_docking\")\n</code></pre>"},{"location":"getting-started/examples/#using-proteinligand-objects","title":"Using Protein/Ligand Objects","text":"<p>You can pass <code>Protein</code> and <code>Ligand</code> objects directly:</p> <pre><code>from docksuitex import Protein, Ligand, VinaDocking\n\nprot = Protein(\"protein.pdb\")\nprot.prepare()\n\nlig = Ligand(\"ligand.sdf\")\nlig.prepare(minimize=\"mmff94\")\n\nvina = VinaDocking(\n    receptor=prot,  # Pass Protein object\n    ligand=lig,     # Pass Ligand object\n    grid_center=(10.0, 12.5, 8.0)\n)\nvina.run()\n</code></pre>"},{"location":"getting-started/examples/#autodock4-docking","title":"AutoDock4 Docking","text":"<pre><code>from docksuitex import AD4Docking\n\n# Initialize AutoDock4 docking\nad4 = AD4Docking(\n    receptor=\"protein_prepared.pdbqt\",\n    ligand=\"ligand_prepared.pdbqt\",\n    grid_center=(10.0, 12.5, 8.0),\n    grid_size=(60, 60, 60),\n    spacing=0.375,\n    ga_run=10,\n    ga_num_evals=2500000\n)\n\n# Run AutoGrid + AutoDock\nad4.run()\n\n# Visualize results (in Jupyter Notebook)\nad4.view_results()\n\n# Save results\nad4.save_results(\"ad4_docking\")\n</code></pre>"},{"location":"getting-started/examples/#batch-docking-with-vina","title":"Batch Docking with Vina","text":"<p>Run multiple ligands against multiple binding pockets in parallel:</p> <pre><code>from docksuitex import BatchVinaDocking\n\n# Input\nreceptor = \"protein_prepared.pdbqt\"\nligands = [\"lig1_prepared.pdbqt\", \"lig2_prepared.pdbqt\", \"lig3_prepared.pdbqt\"]\ncenters = [\n    (10.0, 12.5, 8.0),\n    (-8.2, 14.6, 25.3),\n    (-12.2, -10.1, 8.3)\n]\n\n# Initialize batch docking\nbatch = BatchVinaDocking(\n    receptor=receptor,\n    ligand_list=ligands,\n    center_list=centers,\n    grid_size=(20, 20, 20),\n    exhaustiveness=8,\n    num_modes=9,\n    seed=42\n)\n\n# Run all jobs in parallel\nresults = batch.run_all(save_to=\"batch_vina\")\n\n# Check results\nfor (lig, center), res in results.items():\n    print(f\"Ligand {lig} at center {center} \u2192 {res}\")\n</code></pre>"},{"location":"getting-started/examples/#batch-docking-with-autodock4","title":"Batch Docking with AutoDock4","text":"<pre><code>from docksuitex import BatchAD4Docking\n\n# Input\nreceptor = \"protein_prepared.pdbqt\"\nligands = [\"lig1_prepared.pdbqt\", \"lig2_prepared.pdbqt\"]\ncenters = [(10.0, 12.5, 8.0), (-8.2, 14.6, 25.3)]\n\n# Initialize batch docking\nbatch = BatchAD4Docking(\n    receptor=receptor,\n    ligand_list=ligands,\n    center_list=centers,\n    grid_size=(60, 60, 60),\n    ga_run=10\n)\n\n# Run all jobs in parallel\nresults = batch.run_all(save_to=\"batch_ad4\")\n\nfor (lig, center), res in results.items():\n    print(f\"Ligand {lig} at center {center} \u2192 {res}\")\n</code></pre>"},{"location":"getting-started/examples/#parsing-docking-results","title":"Parsing Docking Results","text":""},{"location":"getting-started/examples/#parse-vina-logs-to-csv","title":"Parse Vina Logs to CSV","text":"<pre><code>from docksuitex.utils import parse_vina_log_to_csv\n\n# Parse all Vina log files in a directory\ndf = parse_vina_log_to_csv(\n    results_dir=\"vina_docking\",\n    output_csv=\"vina_summary.csv\"\n)\n\nprint(df.head())\n</code></pre>"},{"location":"getting-started/examples/#parse-autodock4-dlg-files-to-csv","title":"Parse AutoDock4 DLG Files to CSV","text":"<pre><code>from docksuitex.utils import parse_ad4_dlg_to_csv\n\n# Parse all AutoDock4 DLG files in a directory\ndf = parse_ad4_dlg_to_csv(\n    results_dir=\"ad4_docking\",\n    output_csv=\"ad4_summary.csv\"\n)\n\nprint(df.head())\n</code></pre>"},{"location":"getting-started/examples/#fetching-molecules","title":"Fetching Molecules","text":""},{"location":"getting-started/examples/#fetch-protein-from-rcsb-pdb","title":"Fetch Protein from RCSB PDB","text":"<pre><code>from docksuitex.utils import fetch_pdb\n\n# Download protein structure by PDB ID\npdb_file = fetch_pdb(\"1UBQ\", save_to=\"pdbs\")\nprint(f\"Downloaded: {pdb_file}\")\n</code></pre>"},{"location":"getting-started/examples/#fetch-ligand-from-pubchem","title":"Fetch Ligand from PubChem","text":"<pre><code>from docksuitex.utils import fetch_sdf\n\n# Download ligand by PubChem CID\nsdf_file = fetch_sdf(2244, save_to=\"ligands\")  # Aspirin\nprint(f\"Downloaded: {sdf_file}\")\n</code></pre>"},{"location":"getting-started/examples/#visualization-jupyter-notebook","title":"Visualization (Jupyter Notebook)","text":""},{"location":"getting-started/examples/#view-single-molecule","title":"View Single Molecule","text":"<pre><code>from docksuitex.utils import view_molecule\n\n# View a protein or ligand\nview_molecule(\"protein.pdbqt\")\n</code></pre>"},{"location":"getting-started/examples/#view-docking-results","title":"View Docking Results","text":"<p>Interactive viewer with pose controls:</p> <pre><code>from docksuitex.utils import view_results\n\n# Visualize protein with docking poses\n# Features: step through poses, play/pause animation, show all poses\nview_results(\n    protein_file=\"protein.pdb\",\n    ligand_file=\"ligand_poses.pdbqt\"\n)\n</code></pre>"},{"location":"getting-started/examples/#utility-functions","title":"Utility Functions","text":""},{"location":"getting-started/examples/#clean-temporary-folder","title":"Clean Temporary Folder","text":"<pre><code>from docksuitex.utils import clean_temp_folder\n\n# Clean up temporary files from previous runs\nclean_temp_folder()\n</code></pre>"},{"location":"getting-started/examples/#delete-binaries","title":"Delete Binaries","text":"<pre><code>from docksuitex.utils import delete_binaries\n\n# Delete the bin directory to re-download fresh binaries\ndelete_binaries()\n</code></pre>"},{"location":"getting-started/examples/#complete-end-to-end-workflow","title":"Complete End-to-End Workflow","text":"<p>Putting it all together:</p> <pre><code>from docksuitex import Protein, Ligand, PocketFinder, VinaDocking\nfrom docksuitex.utils import (\n    clean_temp_folder,\n    fetch_pdb,\n    fetch_sdf,\n    parse_vina_log_to_csv\n)\n\n# Clean up\nclean_temp_folder()\n\n# 1. Fetch molecules\nprotein_file = fetch_pdb(\"1HVR\")  # HIV-1 Protease\nligand_file = fetch_sdf(2244)     # Aspirin\n\n# 2. Prepare protein\nprot = Protein(protein_file)\nprot.prepare()\n\n# 3. Prepare ligand\nlig = Ligand(ligand_file)\nlig.prepare(minimize=\"mmff94\")\n\n# 4. Find binding pockets\nfinder = PocketFinder(prot)\npockets = finder.run()\ncenter = pockets[0]['center']\n\n# 5. Run docking\nvina = VinaDocking(\n    receptor=prot,\n    ligand=lig,\n    grid_center=center,\n    grid_size=(20, 20, 20),\n    exhaustiveness=16\n)\nvina.run()\nvina.save_results(\"vina_results\")\n\n# 6. Parse results\ndf = parse_vina_log_to_csv(\"vina_results\", \"vina_results/summary.csv\")\nprint(df)\n</code></pre>"},{"location":"getting-started/examples/#more-examples","title":"More Examples","text":"<p>For additional runnable examples, check out the examples folder on GitHub.</p>"},{"location":"getting-started/installation/","title":"Installation","text":""},{"location":"getting-started/installation/#requirements","title":"Requirements","text":"<ul> <li>Python: 3.8 or higher</li> <li>Operating System: Windows (currently Windows-only)</li> <li>Dependencies: Automatically installed via pip</li> </ul>"},{"location":"getting-started/installation/#prerequisites","title":"Prerequisites","text":"<p>Java (JDK/JRE) is required for P2Rank pocket prediction. Download the latest LTS release from Adoptium Temurin. After installation, make sure Java is added to your System PATH so it can be accessed from the command line.</p> <p>Verify Java installation:</p> <pre><code>java -version\n</code></pre>"},{"location":"getting-started/installation/#install-from-pypi","title":"Install from PyPI","text":"<pre><code>pip install docksuitex\n</code></pre>"},{"location":"getting-started/installation/#install-from-source","title":"Install from Source","text":"<pre><code>git clone https://github.com/MangalamGSinha/DockSuiteX.git\ncd DockSuiteX\npip install .\n</code></pre>"},{"location":"getting-started/installation/#binary-dependencies","title":"Binary Dependencies","text":"<p>DockSuiteX automatically downloads required binary executables on first import:</p> <ul> <li>MGLTools (AutoDockTools)</li> <li>AutoDock Vina</li> <li>AutoDock4 &amp; AutoGrid</li> <li>P2Rank</li> <li>Open Babel</li> </ul> <p>The binaries are downloaded from the GitHub repository and extracted to the package's <code>bin/</code> directory.</p> <p>If binary download fails, you can manually download from: <pre><code>https://github.com/MangalamGSinha/DockSuiteX_Binaries\n</code></pre></p> <p>Extract to: <code>&lt;package_location&gt;/docksuitex/bin/</code></p>"},{"location":"getting-started/quickstart/","title":"Quick Start Guide","text":"<p>Get started with DockSuiteX in minutes! This guide walks you through a complete docking workflow from fetching molecules to analyzing results.</p>"},{"location":"getting-started/quickstart/#complete-workflow-example","title":"Complete Workflow Example","text":"<pre><code>from docksuitex import Protein, Ligand, PocketFinder, VinaDocking\nfrom docksuitex.utils import clean_temp_folder, fetch_pdb, fetch_sdf, parse_vina_log_to_csv\n\n# Clean temporary folder from previous runs\nclean_temp_folder()\n\n# 1. Fetch &amp; prepare protein\nprotein_file = fetch_pdb(\"1HVR\")  # HIV-1 Protease\nprot = Protein(protein_file)\nprot.prepare()\n\n# 2. Fetch &amp; prepare ligand\nligand_file = fetch_sdf(2244)  # Aspirin from PubChem\nlig = Ligand(ligand_file)\nlig.prepare(minimize=\"mmff94\")\n\n# 3. Predict binding pockets\nfinder = PocketFinder(prot)\npockets = finder.run()\ncenter = pockets[0]['center']  # Use the top-ranked pocket\n\n# 4. Run docking (using Vina)\nvina = VinaDocking(\n    receptor=prot,\n    ligand=lig,\n    grid_center=center,\n    grid_size=(20, 20, 20),\n    exhaustiveness=16\n)\nvina.run()\nvina.save_results(\"vina_results\")\n\n# 5. Parse and combine results from multiple runs\nparse_vina_log_to_csv(\"vina_results\", \"vina_results/vina_summary.csv\")\n</code></pre>"},{"location":"getting-started/quickstart/#what-this-does","title":"What This Does","text":"<ol> <li>Fetches molecules: Downloads HIV-1 Protease structure from RCSB PDB and Aspirin from PubChem</li> <li>Prepares protein: Fixes missing residues, adds hydrogens, assigns charges, converts to PDBQT</li> <li>Prepares ligand: Generates 3D coordinates, minimizes energy with MMFF94, converts to PDBQT</li> <li>Predicts pockets: Uses P2Rank machine learning to find potential binding sites</li> <li>Runs docking: Performs AutoDock Vina docking with the top-ranked pocket</li> <li>Parses results: Extracts binding affinities and poses into a CSV file</li> </ol>"},{"location":"getting-started/quickstart/#next-steps","title":"Next Steps","text":"<ul> <li>Check out the Examples page for more use cases</li> <li>Explore the API Reference for detailed documentation</li> <li>View results in Jupyter Notebook using the visualization utilities</li> </ul>"},{"location":"getting-started/quickstart/#visualization-jupyter-only","title":"Visualization (Jupyter Only)","text":"<p>If you're working in Jupyter Notebook, you can visualize results:</p> <pre><code># Visualize the protein\nprot.view()\n\n# Visualize the ligand\nlig.view()\n\n# Visualize docking results with interactive controls\nvina.view_results()\n</code></pre>"}]}